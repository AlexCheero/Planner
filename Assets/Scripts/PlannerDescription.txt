стейт машина крутит экшены сгенеренные планером (хорошо бы сделать так чтобы планер или кто то другой вызывал апдейт, а не чтобы он крутился
у стейт машины постоянно)

планер на старте запускает планирование (пока только один раз), в апдейте ждет, когда план появится и
инитит список действий для стейт машины, чтобы та могла эти экшены крутить.

???кновледж, в той ветке которую я смотрю, представлен простым словарем

экшон борд генерит хэш сеты экшенов (не уверен что они нужны для чего нибудь кроме генерации факторей)
и экшон факторей, в методе гет акшонс у всех факторей генерит экшены и возвращает все что получилось

экшон фактори, в свою очередь, проверяет условия (кновледж) и возвращает список доступных экшенов,
вообще можно придумать какое то более элегантное и более автоматизированное решение генерации доступных действий. надо только подумать =))

транспозиш тейбл держит в себе ворлд модели, по хэшу. если хэш совпадает то добавляет ворлд модель с меньшей глубиной.
хэш для ворд модели был переписан чтобы возвращать значение зависящее от значения а не от ссылки.
вообще там какая то мутная схема и я уверен что ее можно сделать проще